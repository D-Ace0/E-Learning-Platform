<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Join Room Test</title>
  <script src="https://cdn.socket.io/4.5.3/socket.io.min.js"></script>
</head>
<body>
<h1>Join Room Test</h1>
<div>
  <label for="roomName">Room Name:</label>
  <input type="text" id="roomName" placeholder="Enter room name">
</div>
<div>
  <label for="studentId">Student ID:</label>
  <input type="text" id="studentId" placeholder="Enter student ID">
</div>
<button id="joinRoomButton">Join Room</button>
<div>
  <h3>Logs</h3>
  <pre id="logs"></pre>
</div>
<div>
  <h3>Joined Room Info</h3>
  <div id="roomInfo"></div>
</div>
<div>
  <h3>User Details</h3>
  <ul id="userDetails"></ul>
</div>

<script>
  const socket = io('ws://localhost:7316'); // Update port if needed

  const logs = document.getElementById('logs');
  const roomInfo = document.getElementById('roomInfo');
  const userDetails = document.getElementById('userDetails');

  const logMessage = (message) => {
    logs.textContent += `${message}\n`;
  };

  const displayRoomInfo = (room) => {
    roomInfo.innerHTML = `<p>Room Name: ${room.name}</p>`;
  };

  const displayUserDetails = (user) => {
    userDetails.innerHTML = `
        <li><strong>Name:</strong> ${user.name}</li>
        <li><strong>Email:</strong> ${user.email}</li>
        <li><strong>Role:</strong> ${user.role}</li>
        <li><strong>Age:</strong> ${user.age}</li>
      `;
  };

  socket.on('connect', () => {
    logMessage(`Connected to server with id: ${socket.id}`);
  });

  socket.on('disconnect', () => {
    logMessage('Disconnected from server');
  });

  socket.on('error', (error) => {
    logMessage(`Error: ${error}`);
  });

  document.getElementById('joinRoomButton').addEventListener('click', () => {
    const roomName = document.getElementById('roomName').value;
    const studentId = document.getElementById('studentId').value;

    if (roomName && studentId) {
      logMessage(`Joining room "${roomName}" as student "${studentId}"`);
      socket.emit('joinRoom', { roomName, studentId });
    } else {
      logMessage('Please enter both room name and student ID');
    }
  });

  socket.on('roomJoined', (data) => {
    logMessage(`Success: ${data.message}`);
    displayRoomInfo(data.room);
    displayUserDetails(data.user);
  });
</script>
</body>
</html>
